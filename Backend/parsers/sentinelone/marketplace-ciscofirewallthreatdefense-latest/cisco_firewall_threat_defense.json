{
  "attributes": {
    "dataSource.category": "security",
    "dataSource.name": "Cisco Firewall Threat Defense",
    "dataSource.vendor": "Cisco",
    "metadata.product.name": "Cisco Firewall Threat Defense",
    "metadata.product.vendor_name": "Cisco",
    "metadata.version": "1.0.0"
  },
  "patterns": {
    "value": "[\\w\\s\\/$&+:;=?@#|'<>.^*()%!-]+",
    "timestamp": "([a-z]+\\s+[0-9]+\\s+[0-9]+\\s+[0-9:]+)|(\\d{4}-\\d{2}-\\d+T\\d{2}:\\d{2}:\\d{2}Z)"
  },
  "formats": [
    {
      "format": ".*<\\d+>$metadata.original_time=timestamp$\\s$src_endpoint.hostname$\\s\\:\\s$metadata.event_code$\\:\\s$metadata.log_name$",
      "attributes": {
        "class_uid": 6003,
        "activity_id": 99,
        "category_uid": 6,
        "type_uid": 600399,
        "class_name": "API Activity",
        "category_name": "Application Activity",
        "type_name": "API Activity: Other",
        "severity_id": 0
      }
    },
    {
      "format": ".*430001:\\s$_=identifier$: $_=value{attrBlacklist=FTD-1-430001}$",
      "repeat": true,
      "attributes": {
        "class_uid": 4001,
        "activity_id": 99,
        "activity_name": "Intrusion event",
        "category_uid": 4,
        "type_uid": 400199,
        "class_name": "Network Activity",
        "category_name": "Network Activity",
        "type_name": "Network Activity: Other",
        "severity_id": 0,
        "event.type": "Intrusion event"
      }
    },
    {
      "format": ".*430002:\\s$_=identifier$: $_=value{attrBlacklist=FTD-1-430002}$",
      "repeat": true,
      "attributes": {
        "class_uid": 4001,
        "activity_id": 1,
        "activity_name": "Open",
        "category_uid": 4,
        "type_uid": 400101,
        "class_name": "Network Activity",
        "category_name": "Network Activity",
        "type_name": "Network Activity: Open",
        "event.type": "Open"
      }
    },
    {
      "format": ".*430003:\\s$_=identifier$: $_=value{attrBlacklist=FTD-1-430003}$",
      "repeat": true,
      "attributes": {
        "class_uid": 4001,
        "activity_id": 2,
        "activity_name": "Close",
        "category_uid": 4,
        "type_uid": 400102,
        "class_name": "Network Activity",
        "category_name": "Network Activity",
        "type_name": "Network Activity: Close",
        "event.type": "Close"
      }
    },
    {
      "format": ".*430004:\\s$_=identifier$: $_=value{attrBlacklist=FTD-1-430004}$",
      "repeat": true,
      "attributes": {
        "class_uid": 4001,
        "activity_id": 99,
        "activity_name": "File events",
        "category_uid": 4,
        "type_uid": 400199,
        "class_name": "Network Activity",
        "category_name": "Network Activity",
        "type_name": "Network Activity: Other",
        "severity_id": 0,
        "event.type": "File events"
      }
    },
    {
      "format": ".*430005:\\s$_=identifier$: $_=value{attrBlacklist=FTD-1-430005}$",
      "repeat": true,
      "attributes": {
        "class_uid": 4001,
        "activity_id": 99,
        "activity_name": "File malware events",
        "category_uid": 4,
        "type_uid": 400199,
        "class_name": "Network Activity",
        "category_name": "Network Activity",
        "type_name": "Network Activity: Other",
        "severity_id": 0,
        "event.type": "File malware events"
      }
    },
    {
      "format": ".*$_=identifier$: $_=value{attrBlacklist=FTD-1-430001|FTD-1-430002|FTD-1-430003|FTD-1-430004|FTD-1-430005}$",
      "repeat": true
    }
  ],
  "mappings": {
    "version": 0,
    "mappings": [
      {
        "predicate": "true",
        "copies": [
          {"inputs": ["metadata.event_code"], "output": "activity_name", "type": "string"},
          {"inputs": ["metadata.event_code"], "output": "event.type", "type": "string"},
          {"inputs": ["SrcIP"], "output": "observables[0].value", "type": "string"},
          {"inputs": ["DstIP"], "output": "observables[1].value", "type": "string"},
          {"inputs": ["User"], "output": "observables[2].value", "type": "string"}
        ],
        "renames": [
          {"inputs": ["DeviceUUID"], "output": "device.uuid", "type": "string"},
          {"inputs": ["AccessControlRuleAction"], "output": "status", "type": "string"},
          {"inputs": ["ACPolicy"], "output": "unmapped.ACPolicy", "type": "string"},
          {"inputs": ["FirstPacketSecond"], "output": "metadata.original_time", "type": "string"},
          {"inputs": ["Message"], "output": "unmapped.Message", "type": "string"},
          {"inputs": ["Classification"], "output": "status_detail", "type": "string"},
          {"inputs": ["ConnectionID"], "output": "connection_info.uid", "type": "string"},
          {"inputs": ["DstIP"], "output": "dst_endpoint.ip", "type": "string"},
          {"inputs": ["DstPort"], "output": "dst_endpoint.port", "type": "string"},
          {"inputs": ["SrcIP"], "output": "src_endpoint.ip", "type": "string"},
          {"inputs": ["SrcPort"], "output": "src_endpoint.port", "type": "string"},
          {"inputs": ["User"], "output": "actor.user.name", "type": "string"},
          {"inputs": ["Protocol"], "output": "connection_info.protocol_name", "type": "string"},
          {"inputs": ["InitiatorBytes"], "output": "traffic.bytes_out", "type": "string"},
          {"inputs": ["InitiatorPackets"], "output": "traffic.packets_out", "type": "string"},
          {"inputs": ["ResponderBytes"], "output": "traffic.bytes_in", "type": "string"},
          {"inputs": ["ResponderPackets"], "output": "traffic.packets_in", "type": "string"},
          {"inputs": ["ConnectionDuration"], "output": "duration", "type": "string"},
          {"inputs": ["ThreatName"], "output": "unmapped.ThreatName", "type": "string"},
          {"inputs": ["WebApplication"], "output": "app_name", "type": "string"}
        ],
        "constants": [
          {"output": "observables[0].name", "value": "source_ip", "type": "string"},
          {"output": "observables[0].type_id", "value": "2", "type": "string"},
          {"output": "observables[1].name", "value": "destination_ip", "type": "string"},
          {"output": "observables[1].type_id", "value": "2", "type": "string"},
          {"output": "observables[2].name", "value": "user_name", "type": "string"},
          {"output": "observables[2].type_id", "value": "4", "type": "string"}
        ]
      }
    ]
  }
}